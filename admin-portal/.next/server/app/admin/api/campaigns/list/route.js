"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/admin/api/campaigns/list/route";
exports.ids = ["app/admin/api/campaigns/list/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fadmin%2Fapi%2Fcampaigns%2Flist%2Froute&page=%2Fadmin%2Fapi%2Fcampaigns%2Flist%2Froute&appPaths=&pagePath=private-next-app-dir%2Fadmin%2Fapi%2Fcampaigns%2Flist%2Froute.ts&appDir=%2FUsers%2FMatty%2Ftruafrica-poc%2Fadmin-portal%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2FMatty%2Ftruafrica-poc%2Fadmin-portal&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fadmin%2Fapi%2Fcampaigns%2Flist%2Froute&page=%2Fadmin%2Fapi%2Fcampaigns%2Flist%2Froute&appPaths=&pagePath=private-next-app-dir%2Fadmin%2Fapi%2Fcampaigns%2Flist%2Froute.ts&appDir=%2FUsers%2FMatty%2Ftruafrica-poc%2Fadmin-portal%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2FMatty%2Ftruafrica-poc%2Fadmin-portal&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_Matty_truafrica_poc_admin_portal_app_admin_api_campaigns_list_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/admin/api/campaigns/list/route.ts */ \"(rsc)/./app/admin/api/campaigns/list/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/admin/api/campaigns/list/route\",\n        pathname: \"/admin/api/campaigns/list\",\n        filename: \"route\",\n        bundlePath: \"app/admin/api/campaigns/list/route\"\n    },\n    resolvedPagePath: \"/Users/Matty/truafrica-poc/admin-portal/app/admin/api/campaigns/list/route.ts\",\n    nextConfigOutput,\n    userland: _Users_Matty_truafrica_poc_admin_portal_app_admin_api_campaigns_list_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/admin/api/campaigns/list/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhZG1pbiUyRmFwaSUyRmNhbXBhaWducyUyRmxpc3QlMkZyb3V0ZSZwYWdlPSUyRmFkbWluJTJGYXBpJTJGY2FtcGFpZ25zJTJGbGlzdCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFkbWluJTJGYXBpJTJGY2FtcGFpZ25zJTJGbGlzdCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRk1hdHR5JTJGdHJ1YWZyaWNhLXBvYyUyRmFkbWluLXBvcnRhbCUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZNYXR0eSUyRnRydWFmcmljYS1wb2MlMkZhZG1pbi1wb3J0YWwmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQzZCO0FBQzFHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJ1YWZyaWNhLWFkbWluLXBvcnRhbC8/NGU5MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvTWF0dHkvdHJ1YWZyaWNhLXBvYy9hZG1pbi1wb3J0YWwvYXBwL2FkbWluL2FwaS9jYW1wYWlnbnMvbGlzdC9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hZG1pbi9hcGkvY2FtcGFpZ25zL2xpc3Qvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FkbWluL2FwaS9jYW1wYWlnbnMvbGlzdFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hZG1pbi9hcGkvY2FtcGFpZ25zL2xpc3Qvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvTWF0dHkvdHJ1YWZyaWNhLXBvYy9hZG1pbi1wb3J0YWwvYXBwL2FkbWluL2FwaS9jYW1wYWlnbnMvbGlzdC9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hZG1pbi9hcGkvY2FtcGFpZ25zL2xpc3Qvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fadmin%2Fapi%2Fcampaigns%2Flist%2Froute&page=%2Fadmin%2Fapi%2Fcampaigns%2Flist%2Froute&appPaths=&pagePath=private-next-app-dir%2Fadmin%2Fapi%2Fcampaigns%2Flist%2Froute.ts&appDir=%2FUsers%2FMatty%2Ftruafrica-poc%2Fadmin-portal%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2FMatty%2Ftruafrica-poc%2Fadmin-portal&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/admin/api/campaigns/list/route.ts":
/*!***********************************************!*\
  !*** ./app/admin/api/campaigns/list/route.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_auth_rbac__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth/rbac */ \"(rsc)/./lib/auth/rbac.ts\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./lib/supabase/server.ts\");\n\n\n\nasync function GET(request) {\n    try {\n        await (0,_lib_auth_rbac__WEBPACK_IMPORTED_MODULE_1__.requirePlatformAdmin)();\n        const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__.createServerClient)();\n        const searchParams = request.nextUrl.searchParams;\n        const page = parseInt(searchParams.get(\"page\") || \"1\");\n        const limit = parseInt(searchParams.get(\"limit\") || \"50\");\n        const status = searchParams.get(\"status\");\n        const clientId = searchParams.get(\"clientId\");\n        const search = searchParams.get(\"search\");\n        const sortBy = searchParams.get(\"sortBy\") || \"created_at\";\n        const sortOrder = searchParams.get(\"sortOrder\") || \"desc\";\n        const startDate = searchParams.get(\"startDate\");\n        const endDate = searchParams.get(\"endDate\");\n        const campaignMode = searchParams.get(\"campaignMode\");\n        const offset = (page - 1) * limit;\n        // Build query - try to get client info from users table\n        let query = supabase.from(\"campaigns\").select(`\n        *,\n        client:users!campaigns_client_id_fkey(id, email)\n      `, {\n            count: \"exact\"\n        }).range(offset, offset + limit - 1);\n        // Apply filters\n        if (status) {\n            query = query.eq(\"status\", status);\n        }\n        if (clientId) {\n            query = query.eq(\"client_id\", clientId);\n        }\n        if (campaignMode) {\n            query = query.eq(\"campaign_mode\", campaignMode);\n        }\n        if (startDate) {\n            query = query.gte(\"created_at\", startDate);\n        }\n        if (endDate) {\n            query = query.lte(\"created_at\", endDate);\n        }\n        // Apply search\n        if (search) {\n            query = query.or(`name.ilike.%${search}%,description.ilike.%${search}%,company_name.ilike.%${search}%`);\n        }\n        // Apply sorting\n        query = query.order(sortBy, {\n            ascending: sortOrder === \"asc\"\n        });\n        const { data, error, count } = await query;\n        if (error) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: error.message\n            }, {\n                status: 500\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            campaigns: data || [],\n            pagination: {\n                page,\n                limit,\n                total: count || 0,\n                totalPages: Math.ceil((count || 0) / limit)\n            }\n        });\n    } catch (error) {\n        if (error.message === \"redirect\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message || \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYWRtaW4vYXBpL2NhbXBhaWducy9saXN0L3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBdUQ7QUFDRDtBQUNJO0FBRW5ELGVBQWVHLElBQUlDLE9BQW9CO0lBQzVDLElBQUk7UUFDRixNQUFNSCxvRUFBb0JBO1FBRTFCLE1BQU1JLFdBQVdILHdFQUFrQkE7UUFDbkMsTUFBTUksZUFBZUYsUUFBUUcsT0FBTyxDQUFDRCxZQUFZO1FBQ2pELE1BQU1FLE9BQU9DLFNBQVNILGFBQWFJLEdBQUcsQ0FBQyxXQUFXO1FBQ2xELE1BQU1DLFFBQVFGLFNBQVNILGFBQWFJLEdBQUcsQ0FBQyxZQUFZO1FBQ3BELE1BQU1FLFNBQVNOLGFBQWFJLEdBQUcsQ0FBQztRQUNoQyxNQUFNRyxXQUFXUCxhQUFhSSxHQUFHLENBQUM7UUFDbEMsTUFBTUksU0FBU1IsYUFBYUksR0FBRyxDQUFDO1FBQ2hDLE1BQU1LLFNBQVNULGFBQWFJLEdBQUcsQ0FBQyxhQUFhO1FBQzdDLE1BQU1NLFlBQVlWLGFBQWFJLEdBQUcsQ0FBQyxnQkFBZ0I7UUFDbkQsTUFBTU8sWUFBWVgsYUFBYUksR0FBRyxDQUFDO1FBQ25DLE1BQU1RLFVBQVVaLGFBQWFJLEdBQUcsQ0FBQztRQUNqQyxNQUFNUyxlQUFlYixhQUFhSSxHQUFHLENBQUM7UUFDdEMsTUFBTVUsU0FBUyxDQUFDWixPQUFPLEtBQUtHO1FBRTVCLHdEQUF3RDtRQUN4RCxJQUFJVSxRQUFRaEIsU0FDVGlCLElBQUksQ0FBQyxhQUNMQyxNQUFNLENBQUMsQ0FBQzs7O01BR1QsQ0FBQyxFQUFFO1lBQUVDLE9BQU87UUFBUSxHQUNuQkMsS0FBSyxDQUFDTCxRQUFRQSxTQUFTVCxRQUFRO1FBRWxDLGdCQUFnQjtRQUNoQixJQUFJQyxRQUFRO1lBQ1ZTLFFBQVFBLE1BQU1LLEVBQUUsQ0FBQyxVQUFVZDtRQUM3QjtRQUNBLElBQUlDLFVBQVU7WUFDWlEsUUFBUUEsTUFBTUssRUFBRSxDQUFDLGFBQWFiO1FBQ2hDO1FBQ0EsSUFBSU0sY0FBYztZQUNoQkUsUUFBUUEsTUFBTUssRUFBRSxDQUFDLGlCQUFpQlA7UUFDcEM7UUFDQSxJQUFJRixXQUFXO1lBQ2JJLFFBQVFBLE1BQU1NLEdBQUcsQ0FBQyxjQUFjVjtRQUNsQztRQUNBLElBQUlDLFNBQVM7WUFDWEcsUUFBUUEsTUFBTU8sR0FBRyxDQUFDLGNBQWNWO1FBQ2xDO1FBRUEsZUFBZTtRQUNmLElBQUlKLFFBQVE7WUFDVk8sUUFBUUEsTUFBTVEsRUFBRSxDQUFDLENBQUMsWUFBWSxFQUFFZixPQUFPLHFCQUFxQixFQUFFQSxPQUFPLHNCQUFzQixFQUFFQSxPQUFPLENBQUMsQ0FBQztRQUN4RztRQUVBLGdCQUFnQjtRQUNoQk8sUUFBUUEsTUFBTVMsS0FBSyxDQUFDZixRQUFRO1lBQUVnQixXQUFXZixjQUFjO1FBQU07UUFFN0QsTUFBTSxFQUFFZ0IsSUFBSSxFQUFFQyxLQUFLLEVBQUVULEtBQUssRUFBRSxHQUFHLE1BQU1IO1FBRXJDLElBQUlZLE9BQU87WUFDVCxPQUFPakMscURBQVlBLENBQUNrQyxJQUFJLENBQ3RCO2dCQUFFRCxPQUFPQSxNQUFNRSxPQUFPO1lBQUMsR0FDdkI7Z0JBQUV2QixRQUFRO1lBQUk7UUFFbEI7UUFFQSxPQUFPWixxREFBWUEsQ0FBQ2tDLElBQUksQ0FBQztZQUN2QkUsV0FBV0osUUFBUSxFQUFFO1lBQ3JCSyxZQUFZO2dCQUNWN0I7Z0JBQ0FHO2dCQUNBMkIsT0FBT2QsU0FBUztnQkFDaEJlLFlBQVlDLEtBQUtDLElBQUksQ0FBQyxDQUFDakIsU0FBUyxLQUFLYjtZQUN2QztRQUNGO0lBQ0YsRUFBRSxPQUFPc0IsT0FBWTtRQUNuQixJQUFJQSxNQUFNRSxPQUFPLEtBQUssWUFBWTtZQUNoQyxPQUFPbkMscURBQVlBLENBQUNrQyxJQUFJLENBQ3RCO2dCQUFFRCxPQUFPO1lBQWUsR0FDeEI7Z0JBQUVyQixRQUFRO1lBQUk7UUFFbEI7UUFDQSxPQUFPWixxREFBWUEsQ0FBQ2tDLElBQUksQ0FDdEI7WUFBRUQsT0FBT0EsTUFBTUUsT0FBTyxJQUFJO1FBQXdCLEdBQ2xEO1lBQUV2QixRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3RydWFmcmljYS1hZG1pbi1wb3J0YWwvLi9hcHAvYWRtaW4vYXBpL2NhbXBhaWducy9saXN0L3JvdXRlLnRzP2M1ZDgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHsgcmVxdWlyZVBsYXRmb3JtQWRtaW4gfSBmcm9tICdAL2xpYi9hdXRoL3JiYWMnXG5pbXBvcnQgeyBjcmVhdGVTZXJ2ZXJDbGllbnQgfSBmcm9tICdAL2xpYi9zdXBhYmFzZS9zZXJ2ZXInXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBhd2FpdCByZXF1aXJlUGxhdGZvcm1BZG1pbigpXG4gICAgXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTZXJ2ZXJDbGllbnQoKVxuICAgIGNvbnN0IHNlYXJjaFBhcmFtcyA9IHJlcXVlc3QubmV4dFVybC5zZWFyY2hQYXJhbXNcbiAgICBjb25zdCBwYWdlID0gcGFyc2VJbnQoc2VhcmNoUGFyYW1zLmdldCgncGFnZScpIHx8ICcxJylcbiAgICBjb25zdCBsaW1pdCA9IHBhcnNlSW50KHNlYXJjaFBhcmFtcy5nZXQoJ2xpbWl0JykgfHwgJzUwJylcbiAgICBjb25zdCBzdGF0dXMgPSBzZWFyY2hQYXJhbXMuZ2V0KCdzdGF0dXMnKVxuICAgIGNvbnN0IGNsaWVudElkID0gc2VhcmNoUGFyYW1zLmdldCgnY2xpZW50SWQnKVxuICAgIGNvbnN0IHNlYXJjaCA9IHNlYXJjaFBhcmFtcy5nZXQoJ3NlYXJjaCcpXG4gICAgY29uc3Qgc29ydEJ5ID0gc2VhcmNoUGFyYW1zLmdldCgnc29ydEJ5JykgfHwgJ2NyZWF0ZWRfYXQnXG4gICAgY29uc3Qgc29ydE9yZGVyID0gc2VhcmNoUGFyYW1zLmdldCgnc29ydE9yZGVyJykgfHwgJ2Rlc2MnXG4gICAgY29uc3Qgc3RhcnREYXRlID0gc2VhcmNoUGFyYW1zLmdldCgnc3RhcnREYXRlJylcbiAgICBjb25zdCBlbmREYXRlID0gc2VhcmNoUGFyYW1zLmdldCgnZW5kRGF0ZScpXG4gICAgY29uc3QgY2FtcGFpZ25Nb2RlID0gc2VhcmNoUGFyYW1zLmdldCgnY2FtcGFpZ25Nb2RlJylcbiAgICBjb25zdCBvZmZzZXQgPSAocGFnZSAtIDEpICogbGltaXRcblxuICAgIC8vIEJ1aWxkIHF1ZXJ5IC0gdHJ5IHRvIGdldCBjbGllbnQgaW5mbyBmcm9tIHVzZXJzIHRhYmxlXG4gICAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdjYW1wYWlnbnMnKVxuICAgICAgLnNlbGVjdChgXG4gICAgICAgICosXG4gICAgICAgIGNsaWVudDp1c2VycyFjYW1wYWlnbnNfY2xpZW50X2lkX2ZrZXkoaWQsIGVtYWlsKVxuICAgICAgYCwgeyBjb3VudDogJ2V4YWN0JyB9KVxuICAgICAgLnJhbmdlKG9mZnNldCwgb2Zmc2V0ICsgbGltaXQgLSAxKVxuXG4gICAgLy8gQXBwbHkgZmlsdGVyc1xuICAgIGlmIChzdGF0dXMpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ3N0YXR1cycsIHN0YXR1cylcbiAgICB9XG4gICAgaWYgKGNsaWVudElkKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdjbGllbnRfaWQnLCBjbGllbnRJZClcbiAgICB9XG4gICAgaWYgKGNhbXBhaWduTW9kZSkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5lcSgnY2FtcGFpZ25fbW9kZScsIGNhbXBhaWduTW9kZSlcbiAgICB9XG4gICAgaWYgKHN0YXJ0RGF0ZSkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5ndGUoJ2NyZWF0ZWRfYXQnLCBzdGFydERhdGUpXG4gICAgfVxuICAgIGlmIChlbmREYXRlKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5Lmx0ZSgnY3JlYXRlZF9hdCcsIGVuZERhdGUpXG4gICAgfVxuXG4gICAgLy8gQXBwbHkgc2VhcmNoXG4gICAgaWYgKHNlYXJjaCkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5vcihgbmFtZS5pbGlrZS4lJHtzZWFyY2h9JSxkZXNjcmlwdGlvbi5pbGlrZS4lJHtzZWFyY2h9JSxjb21wYW55X25hbWUuaWxpa2UuJSR7c2VhcmNofSVgKVxuICAgIH1cblxuICAgIC8vIEFwcGx5IHNvcnRpbmdcbiAgICBxdWVyeSA9IHF1ZXJ5Lm9yZGVyKHNvcnRCeSwgeyBhc2NlbmRpbmc6IHNvcnRPcmRlciA9PT0gJ2FzYycgfSlcblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IsIGNvdW50IH0gPSBhd2FpdCBxdWVyeVxuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSxcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIGNhbXBhaWduczogZGF0YSB8fCBbXSxcbiAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgcGFnZSxcbiAgICAgICAgbGltaXQsXG4gICAgICAgIHRvdGFsOiBjb3VudCB8fCAwLFxuICAgICAgICB0b3RhbFBhZ2VzOiBNYXRoLmNlaWwoKGNvdW50IHx8IDApIC8gbGltaXQpLFxuICAgICAgfSxcbiAgICB9KVxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgaWYgKGVycm9yLm1lc3NhZ2UgPT09ICdyZWRpcmVjdCcpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XG4gICAgICApXG4gICAgfVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfHwgJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufVxuXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwicmVxdWlyZVBsYXRmb3JtQWRtaW4iLCJjcmVhdGVTZXJ2ZXJDbGllbnQiLCJHRVQiLCJyZXF1ZXN0Iiwic3VwYWJhc2UiLCJzZWFyY2hQYXJhbXMiLCJuZXh0VXJsIiwicGFnZSIsInBhcnNlSW50IiwiZ2V0IiwibGltaXQiLCJzdGF0dXMiLCJjbGllbnRJZCIsInNlYXJjaCIsInNvcnRCeSIsInNvcnRPcmRlciIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJjYW1wYWlnbk1vZGUiLCJvZmZzZXQiLCJxdWVyeSIsImZyb20iLCJzZWxlY3QiLCJjb3VudCIsInJhbmdlIiwiZXEiLCJndGUiLCJsdGUiLCJvciIsIm9yZGVyIiwiYXNjZW5kaW5nIiwiZGF0YSIsImVycm9yIiwianNvbiIsIm1lc3NhZ2UiLCJjYW1wYWlnbnMiLCJwYWdpbmF0aW9uIiwidG90YWwiLCJ0b3RhbFBhZ2VzIiwiTWF0aCIsImNlaWwiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/admin/api/campaigns/list/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth/rbac.ts":
/*!**************************!*\
  !*** ./lib/auth/rbac.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getPlatformAdmin: () => (/* binding */ getPlatformAdmin),\n/* harmony export */   requirePlatformAdmin: () => (/* binding */ requirePlatformAdmin)\n/* harmony export */ });\n/* harmony import */ var next_navigation__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/navigation */ \"(rsc)/./node_modules/next/dist/api/navigation.react-server.js\");\n/* harmony import */ var _session__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./session */ \"(rsc)/./lib/auth/session.ts\");\n/* harmony import */ var _supabase_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../supabase/server */ \"(rsc)/./lib/supabase/server.ts\");\n\n\n\n/**\n * Require platform admin authentication and role\n * Throws redirect if not authenticated or not platform_admin\n * Returns the admin user if valid\n */ async function requirePlatformAdmin() {\n    const session = await (0,_session__WEBPACK_IMPORTED_MODULE_1__.getAdminSession)();\n    if (!session) {\n        (0,next_navigation__WEBPACK_IMPORTED_MODULE_0__.redirect)(\"/login\");\n    }\n    // Verify the user still exists and has platform_admin role\n    const supabase = (0,_supabase_server__WEBPACK_IMPORTED_MODULE_2__.createServerClient)();\n    // Check if user exists in auth.users\n    const { data: authUser, error: authError } = await supabase.auth.admin.getUserById(session.userId);\n    if (authError || !authUser) {\n        (0,next_navigation__WEBPACK_IMPORTED_MODULE_0__.redirect)(\"/login\");\n    }\n    // Check role from admin_profiles table (or users table if that's where role is stored)\n    // For now, we'll check a profiles or users table\n    // Adjust table name based on your schema\n    const { data: profile, error: profileError } = await supabase.from(\"users\").select(\"role\").eq(\"id\", session.userId).single();\n    // If users table doesn't have role, try admin_profiles\n    let role = profile?.role;\n    if (!role && profileError) {\n        const { data: adminProfile } = await supabase.from(\"admin_profiles\").select(\"role\").eq(\"user_id\", session.userId).single();\n        role = adminProfile?.role;\n    }\n    if (role !== \"platform_admin\") {\n        (0,next_navigation__WEBPACK_IMPORTED_MODULE_0__.redirect)(\"/login\");\n    }\n    return {\n        id: session.userId,\n        email: session.email,\n        role: \"platform_admin\"\n    };\n}\n/**\n * Check if current user is platform admin (non-throwing version)\n * Returns null if not authenticated or not platform_admin\n */ async function getPlatformAdmin() {\n    try {\n        return await requirePlatformAdmin();\n    } catch  {\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC9yYmFjLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQTBDO0FBQ0M7QUFDWTtBQVF2RDs7OztDQUlDLEdBQ00sZUFBZUc7SUFDcEIsTUFBTUMsVUFBVSxNQUFNSCx5REFBZUE7SUFFckMsSUFBSSxDQUFDRyxTQUFTO1FBQ1pKLHlEQUFRQSxDQUFDO0lBQ1g7SUFFQSwyREFBMkQ7SUFDM0QsTUFBTUssV0FBV0gsb0VBQWtCQTtJQUVuQyxxQ0FBcUM7SUFDckMsTUFBTSxFQUFFSSxNQUFNQyxRQUFRLEVBQUVDLE9BQU9DLFNBQVMsRUFBRSxHQUFHLE1BQU1KLFNBQVNLLElBQUksQ0FBQ0MsS0FBSyxDQUFDQyxXQUFXLENBQUNSLFFBQVFTLE1BQU07SUFFakcsSUFBSUosYUFBYSxDQUFDRixVQUFVO1FBQzFCUCx5REFBUUEsQ0FBQztJQUNYO0lBRUEsdUZBQXVGO0lBQ3ZGLGlEQUFpRDtJQUNqRCx5Q0FBeUM7SUFDekMsTUFBTSxFQUFFTSxNQUFNUSxPQUFPLEVBQUVOLE9BQU9PLFlBQVksRUFBRSxHQUFHLE1BQU1WLFNBQ2xEVyxJQUFJLENBQUMsU0FDTEMsTUFBTSxDQUFDLFFBQ1BDLEVBQUUsQ0FBQyxNQUFNZCxRQUFRUyxNQUFNLEVBQ3ZCTSxNQUFNO0lBRVQsdURBQXVEO0lBQ3ZELElBQUlDLE9BQU9OLFNBQVNNO0lBQ3BCLElBQUksQ0FBQ0EsUUFBUUwsY0FBYztRQUN6QixNQUFNLEVBQUVULE1BQU1lLFlBQVksRUFBRSxHQUFHLE1BQU1oQixTQUNsQ1csSUFBSSxDQUFDLGtCQUNMQyxNQUFNLENBQUMsUUFDUEMsRUFBRSxDQUFDLFdBQVdkLFFBQVFTLE1BQU0sRUFDNUJNLE1BQU07UUFFVEMsT0FBT0MsY0FBY0Q7SUFDdkI7SUFFQSxJQUFJQSxTQUFTLGtCQUFrQjtRQUM3QnBCLHlEQUFRQSxDQUFDO0lBQ1g7SUFFQSxPQUFPO1FBQ0xzQixJQUFJbEIsUUFBUVMsTUFBTTtRQUNsQlUsT0FBT25CLFFBQVFtQixLQUFLO1FBQ3BCSCxNQUFNO0lBQ1I7QUFDRjtBQUVBOzs7Q0FHQyxHQUNNLGVBQWVJO0lBQ3BCLElBQUk7UUFDRixPQUFPLE1BQU1yQjtJQUNmLEVBQUUsT0FBTTtRQUNOLE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJ1YWZyaWNhLWFkbWluLXBvcnRhbC8uL2xpYi9hdXRoL3JiYWMudHM/YjAyOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZWRpcmVjdCB9IGZyb20gJ25leHQvbmF2aWdhdGlvbidcbmltcG9ydCB7IGdldEFkbWluU2Vzc2lvbiB9IGZyb20gJy4vc2Vzc2lvbidcbmltcG9ydCB7IGNyZWF0ZVNlcnZlckNsaWVudCB9IGZyb20gJy4uL3N1cGFiYXNlL3NlcnZlcidcblxuZXhwb3J0IGludGVyZmFjZSBQbGF0Zm9ybUFkbWluIHtcbiAgaWQ6IHN0cmluZ1xuICBlbWFpbDogc3RyaW5nXG4gIHJvbGU6ICdwbGF0Zm9ybV9hZG1pbidcbn1cblxuLyoqXG4gKiBSZXF1aXJlIHBsYXRmb3JtIGFkbWluIGF1dGhlbnRpY2F0aW9uIGFuZCByb2xlXG4gKiBUaHJvd3MgcmVkaXJlY3QgaWYgbm90IGF1dGhlbnRpY2F0ZWQgb3Igbm90IHBsYXRmb3JtX2FkbWluXG4gKiBSZXR1cm5zIHRoZSBhZG1pbiB1c2VyIGlmIHZhbGlkXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlUGxhdGZvcm1BZG1pbigpOiBQcm9taXNlPFBsYXRmb3JtQWRtaW4+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldEFkbWluU2Vzc2lvbigpXG5cbiAgaWYgKCFzZXNzaW9uKSB7XG4gICAgcmVkaXJlY3QoJy9sb2dpbicpXG4gIH1cblxuICAvLyBWZXJpZnkgdGhlIHVzZXIgc3RpbGwgZXhpc3RzIGFuZCBoYXMgcGxhdGZvcm1fYWRtaW4gcm9sZVxuICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVNlcnZlckNsaWVudCgpXG4gIFxuICAvLyBDaGVjayBpZiB1c2VyIGV4aXN0cyBpbiBhdXRoLnVzZXJzXG4gIGNvbnN0IHsgZGF0YTogYXV0aFVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguYWRtaW4uZ2V0VXNlckJ5SWQoc2Vzc2lvbi51c2VySWQpXG4gIFxuICBpZiAoYXV0aEVycm9yIHx8ICFhdXRoVXNlcikge1xuICAgIHJlZGlyZWN0KCcvbG9naW4nKVxuICB9XG5cbiAgLy8gQ2hlY2sgcm9sZSBmcm9tIGFkbWluX3Byb2ZpbGVzIHRhYmxlIChvciB1c2VycyB0YWJsZSBpZiB0aGF0J3Mgd2hlcmUgcm9sZSBpcyBzdG9yZWQpXG4gIC8vIEZvciBub3csIHdlJ2xsIGNoZWNrIGEgcHJvZmlsZXMgb3IgdXNlcnMgdGFibGVcbiAgLy8gQWRqdXN0IHRhYmxlIG5hbWUgYmFzZWQgb24geW91ciBzY2hlbWFcbiAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvcjogcHJvZmlsZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCd1c2VycycpXG4gICAgLnNlbGVjdCgncm9sZScpXG4gICAgLmVxKCdpZCcsIHNlc3Npb24udXNlcklkKVxuICAgIC5zaW5nbGUoKVxuXG4gIC8vIElmIHVzZXJzIHRhYmxlIGRvZXNuJ3QgaGF2ZSByb2xlLCB0cnkgYWRtaW5fcHJvZmlsZXNcbiAgbGV0IHJvbGUgPSBwcm9maWxlPy5yb2xlXG4gIGlmICghcm9sZSAmJiBwcm9maWxlRXJyb3IpIHtcbiAgICBjb25zdCB7IGRhdGE6IGFkbWluUHJvZmlsZSB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhZG1pbl9wcm9maWxlcycpXG4gICAgICAuc2VsZWN0KCdyb2xlJylcbiAgICAgIC5lcSgndXNlcl9pZCcsIHNlc3Npb24udXNlcklkKVxuICAgICAgLnNpbmdsZSgpXG4gICAgXG4gICAgcm9sZSA9IGFkbWluUHJvZmlsZT8ucm9sZVxuICB9XG5cbiAgaWYgKHJvbGUgIT09ICdwbGF0Zm9ybV9hZG1pbicpIHtcbiAgICByZWRpcmVjdCgnL2xvZ2luJylcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgaWQ6IHNlc3Npb24udXNlcklkLFxuICAgIGVtYWlsOiBzZXNzaW9uLmVtYWlsLFxuICAgIHJvbGU6ICdwbGF0Zm9ybV9hZG1pbicsXG4gIH1cbn1cblxuLyoqXG4gKiBDaGVjayBpZiBjdXJyZW50IHVzZXIgaXMgcGxhdGZvcm0gYWRtaW4gKG5vbi10aHJvd2luZyB2ZXJzaW9uKVxuICogUmV0dXJucyBudWxsIGlmIG5vdCBhdXRoZW50aWNhdGVkIG9yIG5vdCBwbGF0Zm9ybV9hZG1pblxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGxhdGZvcm1BZG1pbigpOiBQcm9taXNlPFBsYXRmb3JtQWRtaW4gfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGF3YWl0IHJlcXVpcmVQbGF0Zm9ybUFkbWluKClcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxufVxuXG4iXSwibmFtZXMiOlsicmVkaXJlY3QiLCJnZXRBZG1pblNlc3Npb24iLCJjcmVhdGVTZXJ2ZXJDbGllbnQiLCJyZXF1aXJlUGxhdGZvcm1BZG1pbiIsInNlc3Npb24iLCJzdXBhYmFzZSIsImRhdGEiLCJhdXRoVXNlciIsImVycm9yIiwiYXV0aEVycm9yIiwiYXV0aCIsImFkbWluIiwiZ2V0VXNlckJ5SWQiLCJ1c2VySWQiLCJwcm9maWxlIiwicHJvZmlsZUVycm9yIiwiZnJvbSIsInNlbGVjdCIsImVxIiwic2luZ2xlIiwicm9sZSIsImFkbWluUHJvZmlsZSIsImlkIiwiZW1haWwiLCJnZXRQbGF0Zm9ybUFkbWluIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth/rbac.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth/session.ts":
/*!*****************************!*\
  !*** ./lib/auth/session.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAdminSession: () => (/* binding */ createAdminSession),\n/* harmony export */   destroyAdminSession: () => (/* binding */ destroyAdminSession),\n/* harmony export */   getAdminSession: () => (/* binding */ getAdminSession)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _supabase_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../supabase/server */ \"(rsc)/./lib/supabase/server.ts\");\n\n\nconst SESSION_COOKIE_NAME = \"admin_session\";\nconst SESSION_MAX_AGE = 60 * 60 * 24 * 7 // 7 days\n;\n/**\n * Create an admin session cookie after successful login\n */ async function createAdminSession(userId) {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    const supabase = (0,_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createServerClient)();\n    // Fetch user details to store in session\n    const { data: user, error } = await supabase.auth.admin.getUserById(userId);\n    if (error || !user) {\n        throw new Error(\"Failed to fetch user for session\");\n    }\n    const sessionData = {\n        userId: user.user.id,\n        email: user.user.email || \"\",\n        role: \"platform_admin\"\n    };\n    cookieStore.set(SESSION_COOKIE_NAME, JSON.stringify(sessionData), {\n        httpOnly: true,\n        secure: \"development\" === \"production\",\n        sameSite: \"lax\",\n        maxAge: SESSION_MAX_AGE,\n        path: \"/\"\n    });\n}\n/**\n * Get the current admin session from cookies\n */ async function getAdminSession() {\n    try {\n        const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n        const sessionCookie = cookieStore.get(SESSION_COOKIE_NAME);\n        if (!sessionCookie?.value) {\n            return null;\n        }\n        try {\n            const session = JSON.parse(sessionCookie.value);\n            return session;\n        } catch  {\n            return null;\n        }\n    } catch  {\n        // cookies() can throw in some contexts, return null\n        return null;\n    }\n}\n/**\n * Destroy the admin session cookie\n */ async function destroyAdminSession() {\n    try {\n        const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n        cookieStore.delete(SESSION_COOKIE_NAME);\n    } catch  {\n    // cookies() can throw in some contexts, ignore\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC9zZXNzaW9uLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQXNDO0FBQ2lCO0FBRXZELE1BQU1FLHNCQUFzQjtBQUM1QixNQUFNQyxrQkFBa0IsS0FBSyxLQUFLLEtBQUssRUFBRSxTQUFTOztBQVFsRDs7Q0FFQyxHQUNNLGVBQWVDLG1CQUFtQkMsTUFBYztJQUNyRCxNQUFNQyxjQUFjLE1BQU1OLHFEQUFPQTtJQUNqQyxNQUFNTyxXQUFXTixvRUFBa0JBO0lBRW5DLHlDQUF5QztJQUN6QyxNQUFNLEVBQUVPLE1BQU1DLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTUgsU0FBU0ksSUFBSSxDQUFDQyxLQUFLLENBQUNDLFdBQVcsQ0FBQ1I7SUFFcEUsSUFBSUssU0FBUyxDQUFDRCxNQUFNO1FBQ2xCLE1BQU0sSUFBSUssTUFBTTtJQUNsQjtJQUVBLE1BQU1DLGNBQTRCO1FBQ2hDVixRQUFRSSxLQUFLQSxJQUFJLENBQUNPLEVBQUU7UUFDcEJDLE9BQU9SLEtBQUtBLElBQUksQ0FBQ1EsS0FBSyxJQUFJO1FBQzFCQyxNQUFNO0lBQ1I7SUFFQVosWUFBWWEsR0FBRyxDQUFDakIscUJBQXFCa0IsS0FBS0MsU0FBUyxDQUFDTixjQUFjO1FBQ2hFTyxVQUFVO1FBQ1ZDLFFBQVFDLGtCQUF5QjtRQUNqQ0MsVUFBVTtRQUNWQyxRQUFRdkI7UUFDUndCLE1BQU07SUFDUjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxlQUFlQztJQUNwQixJQUFJO1FBQ0YsTUFBTXRCLGNBQWMsTUFBTU4scURBQU9BO1FBQ2pDLE1BQU02QixnQkFBZ0J2QixZQUFZd0IsR0FBRyxDQUFDNUI7UUFFdEMsSUFBSSxDQUFDMkIsZUFBZUUsT0FBTztZQUN6QixPQUFPO1FBQ1Q7UUFFQSxJQUFJO1lBQ0YsTUFBTUMsVUFBd0JaLEtBQUthLEtBQUssQ0FBQ0osY0FBY0UsS0FBSztZQUM1RCxPQUFPQztRQUNULEVBQUUsT0FBTTtZQUNOLE9BQU87UUFDVDtJQUNGLEVBQUUsT0FBTTtRQUNOLG9EQUFvRDtRQUNwRCxPQUFPO0lBQ1Q7QUFDRjtBQUVBOztDQUVDLEdBQ00sZUFBZUU7SUFDcEIsSUFBSTtRQUNGLE1BQU01QixjQUFjLE1BQU1OLHFEQUFPQTtRQUNqQ00sWUFBWTZCLE1BQU0sQ0FBQ2pDO0lBQ3JCLEVBQUUsT0FBTTtJQUNOLCtDQUErQztJQUNqRDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJ1YWZyaWNhLWFkbWluLXBvcnRhbC8uL2xpYi9hdXRoL3Nlc3Npb24udHM/ZjY1OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjb29raWVzIH0gZnJvbSAnbmV4dC9oZWFkZXJzJ1xuaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50IH0gZnJvbSAnLi4vc3VwYWJhc2Uvc2VydmVyJ1xuXG5jb25zdCBTRVNTSU9OX0NPT0tJRV9OQU1FID0gJ2FkbWluX3Nlc3Npb24nXG5jb25zdCBTRVNTSU9OX01BWF9BR0UgPSA2MCAqIDYwICogMjQgKiA3IC8vIDcgZGF5c1xuXG5leHBvcnQgaW50ZXJmYWNlIEFkbWluU2Vzc2lvbiB7XG4gIHVzZXJJZDogc3RyaW5nXG4gIGVtYWlsOiBzdHJpbmdcbiAgcm9sZTogc3RyaW5nXG59XG5cbi8qKlxuICogQ3JlYXRlIGFuIGFkbWluIHNlc3Npb24gY29va2llIGFmdGVyIHN1Y2Nlc3NmdWwgbG9naW5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUFkbWluU2Vzc2lvbih1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBjb29raWVTdG9yZSA9IGF3YWl0IGNvb2tpZXMoKVxuICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVNlcnZlckNsaWVudCgpXG4gIFxuICAvLyBGZXRjaCB1c2VyIGRldGFpbHMgdG8gc3RvcmUgaW4gc2Vzc2lvblxuICBjb25zdCB7IGRhdGE6IHVzZXIsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmFkbWluLmdldFVzZXJCeUlkKHVzZXJJZClcbiAgXG4gIGlmIChlcnJvciB8fCAhdXNlcikge1xuICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGZldGNoIHVzZXIgZm9yIHNlc3Npb24nKVxuICB9XG5cbiAgY29uc3Qgc2Vzc2lvbkRhdGE6IEFkbWluU2Vzc2lvbiA9IHtcbiAgICB1c2VySWQ6IHVzZXIudXNlci5pZCxcbiAgICBlbWFpbDogdXNlci51c2VyLmVtYWlsIHx8ICcnLFxuICAgIHJvbGU6ICdwbGF0Zm9ybV9hZG1pbicsIC8vIE9ubHkgcGxhdGZvcm1fYWRtaW4gY2FuIGNyZWF0ZSBzZXNzaW9uc1xuICB9XG5cbiAgY29va2llU3RvcmUuc2V0KFNFU1NJT05fQ09PS0lFX05BTUUsIEpTT04uc3RyaW5naWZ5KHNlc3Npb25EYXRhKSwge1xuICAgIGh0dHBPbmx5OiB0cnVlLFxuICAgIHNlY3VyZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyxcbiAgICBzYW1lU2l0ZTogJ2xheCcsXG4gICAgbWF4QWdlOiBTRVNTSU9OX01BWF9BR0UsXG4gICAgcGF0aDogJy8nLFxuICB9KVxufVxuXG4vKipcbiAqIEdldCB0aGUgY3VycmVudCBhZG1pbiBzZXNzaW9uIGZyb20gY29va2llc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWRtaW5TZXNzaW9uKCk6IFByb21pc2U8QWRtaW5TZXNzaW9uIHwgbnVsbD4ge1xuICB0cnkge1xuICAgIGNvbnN0IGNvb2tpZVN0b3JlID0gYXdhaXQgY29va2llcygpXG4gICAgY29uc3Qgc2Vzc2lvbkNvb2tpZSA9IGNvb2tpZVN0b3JlLmdldChTRVNTSU9OX0NPT0tJRV9OQU1FKVxuXG4gICAgaWYgKCFzZXNzaW9uQ29va2llPy52YWx1ZSkge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2Vzc2lvbjogQWRtaW5TZXNzaW9uID0gSlNPTi5wYXJzZShzZXNzaW9uQ29va2llLnZhbHVlKVxuICAgICAgcmV0dXJuIHNlc3Npb25cbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICB9IGNhdGNoIHtcbiAgICAvLyBjb29raWVzKCkgY2FuIHRocm93IGluIHNvbWUgY29udGV4dHMsIHJldHVybiBudWxsXG4gICAgcmV0dXJuIG51bGxcbiAgfVxufVxuXG4vKipcbiAqIERlc3Ryb3kgdGhlIGFkbWluIHNlc3Npb24gY29va2llXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZXN0cm95QWRtaW5TZXNzaW9uKCk6IFByb21pc2U8dm9pZD4ge1xuICB0cnkge1xuICAgIGNvbnN0IGNvb2tpZVN0b3JlID0gYXdhaXQgY29va2llcygpXG4gICAgY29va2llU3RvcmUuZGVsZXRlKFNFU1NJT05fQ09PS0lFX05BTUUpXG4gIH0gY2F0Y2gge1xuICAgIC8vIGNvb2tpZXMoKSBjYW4gdGhyb3cgaW4gc29tZSBjb250ZXh0cywgaWdub3JlXG4gIH1cbn1cblxuIl0sIm5hbWVzIjpbImNvb2tpZXMiLCJjcmVhdGVTZXJ2ZXJDbGllbnQiLCJTRVNTSU9OX0NPT0tJRV9OQU1FIiwiU0VTU0lPTl9NQVhfQUdFIiwiY3JlYXRlQWRtaW5TZXNzaW9uIiwidXNlcklkIiwiY29va2llU3RvcmUiLCJzdXBhYmFzZSIsImRhdGEiLCJ1c2VyIiwiZXJyb3IiLCJhdXRoIiwiYWRtaW4iLCJnZXRVc2VyQnlJZCIsIkVycm9yIiwic2Vzc2lvbkRhdGEiLCJpZCIsImVtYWlsIiwicm9sZSIsInNldCIsIkpTT04iLCJzdHJpbmdpZnkiLCJodHRwT25seSIsInNlY3VyZSIsInByb2Nlc3MiLCJzYW1lU2l0ZSIsIm1heEFnZSIsInBhdGgiLCJnZXRBZG1pblNlc3Npb24iLCJzZXNzaW9uQ29va2llIiwiZ2V0IiwidmFsdWUiLCJzZXNzaW9uIiwicGFyc2UiLCJkZXN0cm95QWRtaW5TZXNzaW9uIiwiZGVsZXRlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth/session.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase/server.ts":
/*!********************************!*\
  !*** ./lib/supabase/server.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createServerClient: () => (/* binding */ createServerClient)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n/**\n * Server-side Supabase client using service-role key\n * Bypasses RLS and has full database access\n * WARNING: Only use in server components, route handlers, and server actions\n * NEVER expose this to the browser\n */ function createServerClient() {\n    const supabaseUrl = \"https://gcixmuhaybldhfaqnvaa.supabase.co\";\n    const supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n    if (!supabaseUrl || !supabaseServiceRoleKey) {\n        throw new Error(\"Missing Supabase environment variables for server client\");\n    }\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceRoleKey, {\n        auth: {\n            autoRefreshToken: false,\n            persistSession: false\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2Uvc2VydmVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQW9EO0FBRXBEOzs7OztDQUtDLEdBQ00sU0FBU0M7SUFDZCxNQUFNQyxjQUFjQywwQ0FBb0M7SUFDeEQsTUFBTUcseUJBQXlCSCxRQUFRQyxHQUFHLENBQUNHLHlCQUF5QjtJQUVwRSxJQUFJLENBQUNMLGVBQWUsQ0FBQ0ksd0JBQXdCO1FBQzNDLE1BQU0sSUFBSUUsTUFBTTtJQUNsQjtJQUVBLE9BQU9SLG1FQUFZQSxDQUFDRSxhQUFhSSx3QkFBd0I7UUFDdkRHLE1BQU07WUFDSkMsa0JBQWtCO1lBQ2xCQyxnQkFBZ0I7UUFDbEI7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJ1YWZyaWNhLWFkbWluLXBvcnRhbC8uL2xpYi9zdXBhYmFzZS9zZXJ2ZXIudHM/NjYyNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnXG5cbi8qKlxuICogU2VydmVyLXNpZGUgU3VwYWJhc2UgY2xpZW50IHVzaW5nIHNlcnZpY2Utcm9sZSBrZXlcbiAqIEJ5cGFzc2VzIFJMUyBhbmQgaGFzIGZ1bGwgZGF0YWJhc2UgYWNjZXNzXG4gKiBXQVJOSU5HOiBPbmx5IHVzZSBpbiBzZXJ2ZXIgY29tcG9uZW50cywgcm91dGUgaGFuZGxlcnMsIGFuZCBzZXJ2ZXIgYWN0aW9uc1xuICogTkVWRVIgZXhwb3NlIHRoaXMgdG8gdGhlIGJyb3dzZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVNlcnZlckNsaWVudCgpIHtcbiAgY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkxcbiAgY29uc3Qgc3VwYWJhc2VTZXJ2aWNlUm9sZUtleSA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVlcblxuICBpZiAoIXN1cGFiYXNlVXJsIHx8ICFzdXBhYmFzZVNlcnZpY2VSb2xlS2V5KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIFN1cGFiYXNlIGVudmlyb25tZW50IHZhcmlhYmxlcyBmb3Igc2VydmVyIGNsaWVudCcpXG4gIH1cblxuICByZXR1cm4gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZVNlcnZpY2VSb2xlS2V5LCB7XG4gICAgYXV0aDoge1xuICAgICAgYXV0b1JlZnJlc2hUb2tlbjogZmFsc2UsXG4gICAgICBwZXJzaXN0U2Vzc2lvbjogZmFsc2UsXG4gICAgfSxcbiAgfSlcbn1cblxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsImNyZWF0ZVNlcnZlckNsaWVudCIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlU2VydmljZVJvbGVLZXkiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiRXJyb3IiLCJhdXRoIiwiYXV0b1JlZnJlc2hUb2tlbiIsInBlcnNpc3RTZXNzaW9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase/server.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tslib"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fadmin%2Fapi%2Fcampaigns%2Flist%2Froute&page=%2Fadmin%2Fapi%2Fcampaigns%2Flist%2Froute&appPaths=&pagePath=private-next-app-dir%2Fadmin%2Fapi%2Fcampaigns%2Flist%2Froute.ts&appDir=%2FUsers%2FMatty%2Ftruafrica-poc%2Fadmin-portal%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2FMatty%2Ftruafrica-poc%2Fadmin-portal&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();